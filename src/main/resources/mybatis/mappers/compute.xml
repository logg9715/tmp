<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
      PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapper.compute">
	<select id="select_compute_data" resultType="java.util.Map" parameterType="java.util.Map">
		select *, convert(varchar(19), tcc_regdate, 121) as regDate
		from tbl_contract_compute where tcc_code is not null
  		<choose>
  			<when test="searchType == 1 and searchData != ''"> and tcc_no like '%' + #{searchData} + '%' </when>
  			<when test="searchType == 2 and searchData != ''"> and tcc_name like '%' + #{searchData} + '%' </when>
		</choose>
  		order by tcc_code desc
	</select>

	<select id="select_detail_computeinfo" resultType="java.util.Map" parameterType="int">
		select top 1 * from tbl_contract_compute where tcc_code=${value}
	</select>
	
	<insert id="insert_compute_info" parameterType="java.util.Map">
		insert into tbl_contract_compute(
			tcc_tmicode,
			tcc_no,
			tcc_name,
			tcc_standard,
			tcc_price,
			tcc_count,
			tcc_total,
			tcc_commission_rate,
			tcc_commission,
			tcc_etc
		) values(
			${userCode},
			#{text_identification_no},
			#{text_product_name},
			#{text_standard_size},
			#{text_product_price},
			#{text_product_count},
			#{text_total_price},
			#{text_commission_rate},
			#{text_commission_price},
			#{computeEditor}			
		)
	</insert>
	
	<update id="update_compute_info" parameterType="java.util.Map">
		update tbl_contract_compute set
			tcc_tmicode=#{userCode},
			tcc_no=#{text_identification_no},
			tcc_name=#{text_product_name},
			tcc_standard=#{text_standard_size},
			tcc_price=#{text_product_price},
			tcc_count=#{text_product_count},
			tcc_total=#{text_total_price},
			tcc_commission_rate=#{text_commission_rate},
			tcc_commission=#{text_commission_price},
			tcc_etc=#{computeEditor} 
			where tcc_code=#{computeCode}
	</update>
	
	<delete id="delete_compute_info" parameterType="int">
    	delete from tbl_contract_compute where tcc_code=${value};
	</delete>
</mapper>
